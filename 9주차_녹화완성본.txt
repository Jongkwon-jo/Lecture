이겸
안녕하세요, 오늘은 CNN 구조와 이미지 활용이라는 주제로, 제조 현장의 비전 검사 자동화에 대해 말씀드리겠습니다.
최근 제조업에서는 불량률 감소와 품질 일관성 확보가 중요한 과제로 떠오르고 있죠. 특히 사람의 눈으로 판별하기 어려운 미세한 결함이나, 24시간 지속되는 생산 라인에서 일관된 품질을 유지하는 것은 쉽지 않은 일입니다. 
이러한 문제를 해결하기 위해 딥러닝 기술, 특히 합성곱 신경망인 CNN이 어떻게 활용되고 있는지 구체적으로 살펴보겠습니다.

오늘 발표는 크게 세 파트로 구성되어 있습니다
Part 일에서는 CNN 작동 원리를 다룹니다. 합성곱 신경망이 어떻게 이미지를 이해하는지, 핵심 구성요소는 무엇이며, VGG, ResNet 같은 대표 아키텍처들이 어떤 차이를 가지고 있는지 살펴보겠습니다. 또한 실제 학습 과정과 MLOps 파이프라인까지 포괄적으로 설명드릴 예정입니다.
Part 이는 제품 외관 검사 자동화입니다. 스크래치, 오염, 찍힘 같은 결함을 어떻게 자동으로 탐지하는지, 데이터셋은 어떻게 구축하며, 실제 현장에 배치할 때는 어떤 아키텍처를 선택해야 하는지 구체적인 사례와 함께 말씀드리겠습니다.
Part 삼은 용접과 조립 품질 검사입니다. 제조 공정의 핵심인 용접 비드 품질이나 조립 정렬 상태를 AI로 검사하는 방법과, 생산 라인에 통합하는 과정까지 다루겠습니다.

우선, 산업 비전 검사에서 CNN이 왜 필요한지부터 이야기해보겠습니다. 기존의 규칙 기반 검사 방식은 명확한 기준이 있을 때는 효과적이지만, 조명 변화나 복잡한 패턴 앞에서는 한계가 있었습니다. 예를 들어 반사가 심한 금속 표면이나, 미세한 스크래치 같은 경우는 임계값만으로 판단하기 어렵죠.
CNN은 이런 문제를 해결합니다. 카메라와 조명으로 이미지를 캡처하면, CNN 모델이 수백만 개의 학습된 패턴을 기반으로 정상과 불량을 구분합니다. 단순히 밝기나 경계만 보는 게 아니라, 텍스처, 형상, 맥락까지 종합적으로 판단하는 거죠.
기대효과도 명확합니다. 불량률은 감소하고, 검사 속도는 빨라지며, 무엇보다 24시간 내내 일관된 기준으로 판정할 수 있습니다. 사람의 피로도나 주관적 판단이 개입하지 않기 때문에 추적성도 확보됩니다.

합성곱 신경망, 즉 Convolutional Neural Network가 어떻게 이미지를 '이해'하는지 핵심 메커니즘을 풀어보겠습니다.
CNN의 가장 큰 특징은 합성곱 연산을 통해 특징을 계층적으로 학습한다는 점입니다. 낮은 층에서는 엣지나 코너 같은 기본적인 패턴을, 깊은 층으로 갈수록 더 복잡한 형상이나 객체를 인식하게 되죠. 
또한 파라미터 공유를 통해 연산 효율을 확보합니다. 같은 필터가 이미지 전체를 스캔하기 때문에 위치가 바뀌어도 동일한 특징을 감지할 수 있습니다.
현업 적용 관점에서는 정확도와 속도의 균형이 중요합니다. 아무리 정확해도 추론 시간이 길면 생산 라인에서 쓸 수 없고, 반대로 빨라도 불량을 놓치면 의미가 없죠. 

CNN의 발전 과정을 간략히 짚어보겠습니다. 핵심 개념은 세 가지입니다. 
첫째, 지역적 수용 영역입니다. 필터가 이미지의 작은 영역을 보면서 특징을 추출하죠. 
둘째, 가중치 공유입니다. 동일한 필터를 전체 이미지에 적용해서 위치 불변성을 확보합니다. 
셋째, 계층적 표현입니다. 낮은 층에서 추출된 단순한 특징이 쌓여서 고수준의 의미를 만들어내는 거죠.
역사적으로 보면 1998년 LeNet이 손글씨 인식으로 가능성을 보여줬고, 2012년 AlexNet이 ImageNet 대회에서 압도적인 성능을 보이며 딥러닝 시대를 열었습니다. 이후 2015년 레스에서 스킵 연결이라는 혁신이 등장하면서 수백 개의 층을 쌓을 수 있게 됐죠.
오늘날의 과제는 정확도와 지연시간의 균형입니다. 제조 현장에서는 밀리초 단위의 반응 속도가 필요한 경우도 많기 때문에, 경량화와 최적화가 중요한 연구 주제가 되고 있습니다. 

이제 CNN의 핵심 구성요소 세 가지를 살펴보겠습니다. 첫 번째는 합성곱 레이어입니다. 입력 이미지에 필터, 즉 커널을 슬라이딩하면서 특징 맵을 추출합니다. 
이 과정에서 가중치를 공유하기 때문에 파라미터 수가 대폭 줄어들고, 위치가 바뀌어도 같은 패턴을 인식할 수 있습니다. 예를 들어 스크래치가 왼쪽에 있든 오른쪽에 있든 감지할 수 있는 거죠.
두 번째는 풀링 레이어입니다. 특징 맵의 공간 크기를 줄여서 연산량을 줄이고, 작은 변형에 강건해지도록 만듭니다. 
Max Pooling은 가장 강한 신호만 남기고, Average Pooling은 평균값으로 부드럽게 처리하죠.
세 번째는 활성화 함수입니다. 렐루가 가장 널리 쓰이는데, 음수는 0으로 만들고 양수는 그대로 통과시킵니다. 비선형성을 도입해서 복잡한 패턴을 학습할 수 있게 되는 거죠.
 이 세 가지 요소가 반복적으로 쌓이면서 이미지를 이해하는 능력이 생깁니다. 

다음은 합성곱 연산을 제어하는 주요 하이퍼파라미터들을 알아보겠습니다. 
첫째, 커널 크기입니다. 3 by 3, 5 by 5 같은 필터 크기를 의미하는데, 작은 커널은 국소적 특징에, 큰 커널은 넓은 범위의 패턴에 적합합니다. 요즘은 3 by 3을 여러 번 쌓는 게 효율적이라는 게 정설이죠.
둘째, 스트라이드입니다. 필터를 몇 칸씩 이동할지를 정합니다. 스트라이드가 1이면 한 칸씩, 2면 두 칸씩 건너뛰는 거죠. 값이 클수록 출력 크기가 줄어들고 연산량도 감소합니다.
셋째, 패딩입니다. 입력 가장자리에 0을 추가해서 출력 크기를 유지하거나, 경계 정보 손실을 방지합니다. 
이 파라미터들을 조합하면 리셉티브 필드, 즉 하나의 뉴런이 실제로 보는 입력 영역의 크기가 결정됩니다. 제조 검사에서는 결함의 크기에 따라 이 값을 조절해야 합니다. 

이제 CNN 내부에서 정보가 어떻게 변환되는지 이해해보겠습니다. 
먼저 채널 개념입니다. 채널은 정보의 '깊이'를 나타내는 축입니다. 입력 이미지가 RGB라면 3개 채널이죠. 합성곱을 거치면서 엣지 채널, 텍스처 채널 같은 의미 있는 채널들로 변환됩니다. 채널 수가 늘어날수록 더 다양한 특징을 포착할 수 있지만, 연산량도 증가하죠.
필터는 특징을 찾아내는 '스캐너' 역할을 합니다. 하나의 필터가 하나의 출력 채널을 생성합니다. 필터가 64개면 64개의 특징 맵이 나오는 거죠. 낮은 층의 필터는 단순한 선이나 점을, 깊은 층의 필터는 복잡한 패턴이나 객체 부위를 감지하게 학습됩니다.
마지막으로 피처맵입니다. 피처맵은 필터가 이미지 전체를 훑으며 감지한 특징의 활성화 정도를 지도로 표현한 결과물입니다.

이제 실제로 많이 쓰이는 아키텍처들을 비교해보겠습니다. 
첫째, VGG입니다. 2014년에 나왔고, 3 by 3 필터를 깊이 쌓은 단순한 구조입니다. 이해하기 쉽고 구현도 간단하지만, 파라미터가 1억 개가 넘어서 메모리를 많이 씁니다. 정확도는 높지만 느린 편이죠.
둘째, ResNet입니다. 2015년에 등장한 혁신적인 모델로, 스킵 연결이라는 구조를 도입했습니다. 입력을 출력에 바로 더해주는 방식인데, 이를 통해 기울기 소실 문제를 해결하고 수백 개의 층을 쌓을 수 있게 됐죠. ResNet-50이나 ResNet-101이 산업 현장에서 자주 쓰입니다.
셋째, EfficientNet입니다. 2019년에 나온 모델로, 깊이, 너비, 해상도를 동시에 최적화하는 복합 스케일링 기법을 적용했습니다. 적은 파라미터로 높은 정확도를 내기 때문에 엣지 디바이스에 적합하죠.
선택 기준은 명확합니다. 정확도가 최우선이면 ResNet, 속도가 중요하면 EfficientNet, 메모리가 넉넉하면 VGG를 고려할 수 있습니다. 다음은 실제 학습 과정을 살펴보겠습니다.

딥러닝 모델을 실제로 만드는 전체 파이프라인을 보겠습니다. 
첫 단계는 데이터 준비입니다. 전체 데이터를 Train, Validation, Test 세 개로 나눕니다. Train으로 학습하고, Validation으로 하이퍼파라미터를 튜닝하며, Test로 최종 성능을 평가하죠. 비율은 보통 7대2대1 정도입니다. 필요에 따라 데이터를 전처리하거나 증강을 통해 데이터를 구성합니다.
두 번째는 학습 설정입니다. 모델 학습 전, 손실 함수와 옵티마이저 선택해야합니다. 손실 함수는 분류 문제에서 Cross Entropy, 불균형 데이터일 경우 Focal Loss를 씁니다. 옵티마이저는 SGD나 Adam-W가 많이 쓰이죠. Adam-W는 학습률 조정을 자동으로 해주고, SGD는 수렴이 안정적입니다.
세 번째는 학습 루프 구성입니다. 역전파로 가중치를 업데이트하는데, 학습률을 점진적으로 줄이는 스케줄러를 쓰면 성능이 향상됩니다. Cosine Annealing이나 Step-LR 같은 기법이 있죠. 추가적으로 조기 종료를 통해, Validation Loss가 더 이상 개선되지 않으면 학습을 멈춰서 과적합을 방지합니다.
마지막은 산출물로는 학습된 가중치 파일과 추론 스크립트가 나옵니다.

 이제 모델을 안정화하는 기법들을 보겠습니다. 모델이 학습 데이터에만 과적합되지 않고, 실제 현장에서도 잘 작동하게 만드는 세 가지 핵심 기법을 살펴보겠습니다.
첫째, 배치 정규화입니다. 각 층의 입력 분포를 평균 0, 분산 1로 정규화해서 학습을 안정시킵니다. 학습 속도가 빨라지고, 초깃값에 덜 민감해지는 장점이 있죠. 다만 배치 크기에 의존적이라는 한계가 있어서, 작은 배치를 쓸 때는 레이어 정규화를 고려해야 합니다.
둘째, 드롭아웃입니다. 학습 중에 일부 뉴런을 무작위로 꺼서 네트워크가 특정 경로에만 의존하지 않도록 만듭니다. 과적합 방지에 효과적이지만, 추론 시에는 꺼야 하고, 배치 정규화와 함께 쓸 때는 순서를 잘 고려해야 합니다.
셋째, 데이터 증강입니다. Cut-Mix로 이미지를 섞거나, Color-Jitter로 색상을 변형해서 다양한 상황을 학습시킵니다. 제조 검사에서는 실제 조명 변화나 각도 변화를 시뮬레이션하는 게 중요하죠. 
이 기법들을 적절히 조합하면 현장 적용 시 성능 저하를 최소화할 수 있습니다. 다음은 운영 관점의 ML-Ops를 보겠습니다.

모델을 한 번 만들고 끝나는 게 아니라, 지속적으로 관리하고 개선해야 ML-Ops과정이 있습니다.
첫 단계는 데이터 버저닝입니다. 데이터셋이 바뀔 때마다 버전을 기록해서 추적성을 확보합니다. DVC 같은 도구를 쓰면 Git처럼 데이터를 관리할 수 있죠. 실험 추적도 중요합니다.
MLflow나 Weights & Biases로 하이퍼파라미터와 성능 지표를 자동으로 로깅해서, 나중에 어떤 설정이 최선이었는지 비교할 수 있습니다.
두 번째는 모델 레지스트리입니다. 검증을 통과한 모델만 프로덕션으로 올라가도록 게이트를 두는 거죠.
세 번째는 배포 및 서빙입니다.  A/B 테스트로 신규 모델과 기존 모델을 동시에 운영하면서 성능을 비교할 수도 있습니다.
네 번째는 모니터링 및 재학습입니다. 실시간으로 모니터링하다가 성능이 떨어지거나 데이터 분포가 바뀌면 자동으로 재학습을 시작하는 거죠. 
이런 루프가 돌아야 모델이 항상 최신 상태를 유지할 수 있습니다.

AI 모델의 성능을 정확히 측정하는 지표들을 살펴보겠습니다. 태스크마다 중요한 지표가 다릅니다.
정확도는 전체 중 맞춘 비율이고, 정밀도는 불량이라고 예측한 것 중 진짜 불량의 비율, 재현율은 실제 불량 중 찾아낸 비율입니다. F-one 스코어는 이 둘의 조화 평균이죠. 제조 검사에서는 보통 재현율이 더 중요합니다. 불량을 놓치면 안 되니까요.
검출 문제는 mAP를 씁니다. Mean Average Precision의 약자로, 여러 IoU 임계값에서 평균을 낸 값입니다. mAP@.5는 IoU가 50% 이상일 때 측정한 평균입니다. AR은 Average Recall로, 탐지 개수별 재현율 평균이죠.
세그멘테이션은 IoU와 Dice 계수를 씁니다. 예측 영역과 실제 영역이 얼마나 겹치는지를 보는 거죠. 운영 지표로는 지연시간, 처리량, 오탐율이 중요합니다. 밀리초 단위의 추론 시간이 생산 속도를 결정하니까요.

Part 이를 시작하겠습니다. 이제 CNN 이론을 실제 제조 현장에 어떻게 적용하는지 구체적으로 보겠습니다.
제품 외관 검사는 스마트폰, 자동차 부품, 가전제품 등 표면 품질이 중요한 산업에서 핵심입니다. 사람의 눈으로는 피로도 때문에 일관성이 떨어지고, 미세한 스크래치는 놓치기 쉽죠. 조명 각도가 바뀌면 같은 결함도 다르게 보입니다.
목표는 명확합니다. 24시간 7일 내내 동일한 기준으로 검사하고, 사람보다 빠르고 정확하게 불량을 탐지하는 겁니다. 미세 스크래치나 조명 반사 같은 변수에도 강건해야 하고요.
로드맵은 3단계입니다. POC로 개념 검증을 하고, 파일럿으로 한 라인에서 실증한 뒤, 전체 라인으로 확산하는 거죠. 
각 단계마다 성능 지표와 투자 대비 효과를 명확히 해야 경영진 설득이 가능합니다. 먼저 문제 정의부터 시작하겠습니다.

외관 검사 자동화가 해결하려는 문제와 기대효과를 명확히 하겠습니다.
검사 범위는 단순 유무 검사를 넘어섭니다. 스크래치의 길이와 깊이, 오염의 면적과 위치, 찍힘의 크기, 덴트의 깊이, 프린트 불량까지 다양합니다. 각 결함마다 합격 기준이 다르기 때문에, 이걸 AI가 학습해야 하죠.
핵심 KPI는 세 가지입니다. 첫째, 불량 탐지율인 Recall입니다. 불량을 놓치면 고객 불만으로 이어지니까요. 둘째, 오탐율인 Precision입니다. 정상을 불량이라고 하면 생산 효율이 떨어집니다. 셋째, Takt Time입니다. 한 제품당 검사 시간이 생산 속도를 따라가야 하죠.
도입에 대한 기대효과는 명확합니다. 수율이 올라가고, 인건비와 재작업 비용이 줄며, 모든 판정 기록이 남아서 추적성이 확보됩니다. 고객 클레임도 줄어들고요. 
이제 AI를 학습시키기 위한 데이터를 어떻게 모으는지 보겠습니다.

고품질 AI 모델은 고품질 데이터에서 나옵니다. 데이터 수집부터 검수까지의 전체 프로세스를 보겠습니다.
첫 단계는 수집입니다. 제조 현장은 보통 정상 제품이 훨씬 많아서 클래스 불균형이 심합니다. 불량 샘플을 일부러 더 모으거나, 오버샘플링 기법으로 균형을 맞춰야 하죠. 하드 마이닝도 중요합니다. 모델이 틀리는 어려운 샘플을 집중적으로 추가하는 거죠.
두 번째는 기준 수립입니다. 기준이 모호하면 라벨러마다 다르게 작업하므로, 명확한 가이드라인이 필수입니다.
세 번째는 라벨링입니다. 바운딩 박스로 결함 위치를 표시하거나, 마스크로 정확한 경계를 그리거나, 폴리곤으로 불규칙한 형상을 표현합니다.
네 번째는 검수입니다. 한 명이 작업한 걸 다른 사람이 재검토하고, 의견이 다르면 합의하는 프로세스가 필요합니다. 품질 지표로 라벨 일치율을 측정하고, 80% 이상을 유지해야 모델이 제대로 학습됩니다. 

다음으로 전처리와 증강 기법에 대해 살펴보겠습니다. 특히 제조 현장의 가장 큰 변수는 조명이기 때문에, 이를 극복하는 전처리와 증강 기법을 살펴보겠습니다.
광학 전처리는 물리적 접근입니다. 편광 필터로 난반사를 줄이거나, 돔 조명으로 그림자를 제거하거나, HDR 스태킹으로 명암 차이가 큰 이미지를 합치는 거죠. 이렇게 하면 입력 이미지 자체의 품질이 올라갑니다.
데이터 증강은 소프트웨어적 접근입니다. 밝기를 랜덤하게 조절하거나, 가우시안 블러로 초점 변화를 시뮬레이션하거나, 스펙클 노이즈를 추가해서 센서 노이즈를 재현합니다. Cut-Mix로 여러 샘플을 섞어서 일반화 능력을 높이기도 하죠.
도메인 랜덤화는 더 극단적인 방법입니다. 조명 각도, 색온도, 노출 시간을 무작위로 바꿔가며 학습시켜서, 실제 현장에서 어떤 조건이 와도 견딜 수 있게 만드는 겁니다.

프로젝트 목적에 맞는 비전 검사 방식을 선택하는 게 중요합니다. 세 가지 접근법을 비교하겠습니다.
첫째, 가장 기본적인 분류입니다. OK냐 NG냐만 판단하면 되는 가장 단순한 방식이죠. MobileNet 같은 경량 모델로도 충분하고, 라벨링 비용도 낮습니다. 전체 이미지만 보면 되니까요. 초기 도입에 적합합니다.
둘째, 검출입니다. 결함이 어디에 있는지 박스로 표시합니다. 한 제품에 여러 결함이 있을 때 유용하죠. YOLO나 Anchor-free 모델이 많이 쓰입니다. 작은 결함을 찾으려면 해상도가 높아야 합니다.
셋째, 세그멘테이션입니다. 결함의 정확한 경계와 면적을 알아야 할 때 씁니다. U-Net이 대표적이고, 면적 기준으로 합격 여부를 판정할 수 있죠. 라벨링 비용이 가장 높습니다.

하드웨어부터 AI 추론까지 전체 검사 시스템을 어떻게 구성하는지 보겠습니다.
먼저 이미지 취득입니다. 카메라와 렌즈를 제어하고, 조명 및 트리거를 설정하면서 좋은 품질의 이미지가 수집되도록 합니다.
다음으로 전처리 단계입니다. 전처리 단계에서는 이미지를 정규화하고 노이즈를 제거하는 등 화질 개선과 배치를 구성합니다.
세 번째 단계는 AI 추론입니다. 학습된 이미지기반 모델이 결함을 탐지하죠. 후처리에서 NMS로 중복 검출을 제거하고, 임계값으로 최종 판정을 내립니다.
마지막 통합제어가 핵심입니다. 판정 신호 송출이 공정 속도와 일치되도록 설정합니다. 컨베이어 속도가 분당 30미터라면, 제품이 시야에 들어오는 순간을 정확히 포착해야 합니다. 셔터 속도와 노출 시간도 움직임 블러를 피하도록 조절해야 하고요. 

다음은 배치 아키텍처를 비교하겠습니다. AI 모델을 어디서 실행할지, 세 가지 옵션을 살펴보겠습니다.
첫째, 엣지 디바이스입니다. 현장 카메라 옆에 Jetson이나 산업용 PC를 붙이는 방식이죠. 지연시간이 가장 짧고, 네트워크 단절에도 동작합니다. 현장 제약에 빠르게 대응할 수 있지만, 디바이스마다 개별 관리해야 하는 부담이 있습니다.
둘째, 온프레미스 서버입니다. 공장 내 GPU 서버를 두고 여러 라인이 공유하는 방식입니다. 통합 관리가 쉽고, 보안이 확실하며, 네트워크 비용이 없습니다. 다만 초기 투자가 크고, 증설 시 하드웨어를 추가해야 하죠.
셋째, 클라우드입니다. AWS나 Azure에서 추론을 돌리는 방식입니다. 확장성이 뛰어나고, AutoML 같은 서비스를 쓸 수 있지만, 네트워크 지연과 비용이 변수입니다. 민감한 제조 데이터를 외부로 보내는 것도 고려해야 하고요.
선택 기준은 명확합니다. 지연시간이 중요하면 엣지, 보안과 통합 관리가 중요하면 온프레미스, 확장성과 유연성이 중요하면 클라우드를 선택하면 됩니다. 이제 운영 지표를 보겠습니다.

실시간으로 생산 라인을 모니터링하는 대시보드를 예시를 통해 살펴보겠습니다. 세 가지 영역으로 나뉩니다.
첫째, 생산 지표입니다. 처리량은 시간당 몇 개를 검사했는지, 사이클 타임은 제품 하나당 검사 시간이 얼마인지를 보여줍니다. 가동률은 시스템이 실제로 돌아간 시간의 비율이죠. 
둘째, 품질 지표입니다. Precision은 불량이라고 판정한 것 중 실제 불량의 비율이고, Recall은 전체 불량 중 찾아낸 비율입니다. 오탐과 미탐 건수도 실시간으로 집계되어 트렌드를 파악할 수 있습니다. 예를 들어 특정 시간대에 오탐이 급증하면 조명이나 컨베이어 속도 변화를 의심해볼 수 있죠.
셋째, 운영 지표입니다. 알람 발생 횟수, 리젝 레이트, MTBF 같은 값들이 표시됩니다. MTBF는 평균 고장 간격인데, 시스템 안정성을 나타내는 지표입니다.
슬라이스 기능도 중요합니다. 라인별, 모델별, 로트별로 필터링해서 어느 구간에서 문제가 생기는지 바로 파악할 수 있죠. 이런 대시보드가 있어야 현장 관리자가 즉각 대응할 수 있습니다.

다음은 스마트폰 외관 검사 프로젝트 예시를 통해 PoC 사례를 보겠습니다. 
데이터는 2만 장의 고해상도 이미지를 수집했습니다. 스크래치, 찍힘, 얼룩 등 8종의 핵심 결함 유형들을 라벨링했죠. 정상과 불량의 비율을 7대3으로 구성하여 데이터 불균형을 완화했습니다.
결과는 mAP 50 기준으로 0.92, 즉 92%의 정확도를 달성했고, 이때 Recall은 0.95로 나왔습니다. 95%의 불량을 찾아낸다는 의미죠. 엣지 디바이스에서 35FPS로 돌아가서 실시간 검사가 가능했습니다.
핵심 인사이트는 두 가지입니다. 첫째, 금속 재질의 난반사 해결을 위한 조명 시스템의 일관성이 모델 성능의 핵심이었습니다. 둘째, 하드 마이닝 효과가 컸습니다. 모델이 틀린 샘플 500장을 추가로 학습시키니 Recall이 5%나 올라갔습니다.

AI 검사 시스템을 도입할 때 가장 궁금한 게 투자 대비 효과 ROI죠. 경제성에 대한 시뮬레이션 결과를 보겠습니다.
투자 비용은 크게 네 가지입니다. 산업용 카메라와 조명과 같은 하드웨어 비용이 육천만 원, 소프트웨어 개발이 오천만원, 시스템 통합 비용이 삼천만원 정도 예상됩니다. 초기 현장 설치 및 운영자 교육 비용까지 포함하면 총 1억5천만원 정도 투자 금액이 예상됩니다.
절감 효과는 네 가지입니다. 인건비가 절감되고, 재작업 비용이 줄고, 스크랩이 감소하며, 고객 클레임을 줄일 수 있습니다. 연간으로 환산하면 약 2억 4천만 원의 비용이 줄어드는 셈이죠.
회수 기간은 8.5개월로 추정됩니다. 가정에 따라 달라지지만, 1년 내외면 투자금을 회수할 수 있다는 계산입니다. 
다만 리스크도 있습니다. 오탐이 많으면 정상 제품을 버리는 비용이 발생하고, 시스템 다운타임이 길면 생산이 멈춥니다. 이 부분을 고려해서 여유 있게 계획해야 합니다.

이제 외관을 넘어서 제조 공정의 핵심인 용접과 조립 품질을 AI로 검사하는 방법을 다루겠습니다.
용접은 자동차, 조선, 건설기계 등에서 구조적 안전을 좌우하는 중요한 공정입니다. 비드의 형상, 기공, 언더컷 같은 결함은 강도 저하로 이어지죠. 
조립은 부품 간 정렬, 간극, 체결 상태를 확인해야 합니다. 미세한 오차도 진동이나 소음 문제로 나타날 수 있습니다.
규제와 안전 기준도 고려해야 합니다. ISO 3,8,3,4 같은 용접 품질 표준이나, 자동차 산업의 IATF 1,6,9,4,9 같은 규격을 충족해야 하죠. AI 판정의 근거를 추적할 수 있어야 인증도 가능합니다.
목표는 명확합니다. 숙련 검사자 수준의 정확도를 유지하면서, 24시간 연속 검사가 가능하게 만드는 겁니다. 먼저 결함 유형부터 정리하겠습니다.

용접과 조립에서 발생하는 주요 결함들을 정리해보겠습니다.
용접 결함은 다섯 가지가 대표적입니다. 미용접은 용접이 안 된 부분이 남은 거고, 기공은 비드 내부에 기포가 생긴 겁니다. 언더컷은 모재가 패인 형상이고, 스패터는 튀어나온 금속 입자죠. 과용접은 비드가 지나치게 높게 쌓인 경우입니다.
조립 결함도 다섯 가지입니다. 오정렬은 부품이 비뚤어진 거고, 누락은 필요한 부품이 빠진 경우입니다. 역삽은 방향이 반대로 조립된 거고, 간극 과대나 과소는 부품 사이 거리가 기준을 벗어난 겁니다.
판정 기준은 ISO 표준이나 사내 기준을 명확히 정의해야 합니다. 예를 들어 기공은 직경 2mm 이하 3개까지는 허용, 언더컷은 깊이 0.5mm 이하 같은 식이죠. 이 기준이 AI 학습의 라벨이 됩니다.

다음은 데이터 수집 방법입니다. 용접과 조립 검사를 위한 데이터 수집은 외관 검사보다 복잡합니다.
센서 구성부터 달라집니다. RGB 카메라로 표면 텍스처를 보고, 라인 스캔 카메라로 빠르게 움직이는 비드를 캡처하며, 레이저 프로파일러로 Three-D 형상과 깊이를 측정합니다. 이 세 가지를 조합해야 결함을 정확히 파악할 수 있죠.
라벨링은 마스크 기반으로 진행합니다. 비드의 경계선을 폴리곤으로 그리고, 결함 위치를 마스크로 표시합니다. 기공 같은 내부 결함은 X-ray 검사 결과를 참조하기도 하죠.
동기화가 핵심입니다. 용접 토치가 움직이는 속도와 경로를 기록해서, 이미지의 어느 위치가 실제 제품의 어느 지점인지 매칭해야 합니다. 이 과정이 정확해야 GT가 의미를 가집니다.

용접 비드를 정밀하게 분할하는 세그멘테이션 기법을 살펴보겠습니다.
모델은 U-Net이나 DeepLabV3+를 주로 씁니다. U-Net은 의료 영상에서 출발했지만, 용접 비드처럼 경계가 중요한 태스크에도 효과적이죠. 엣지 추론을 고려하면 MobileNet V3 백본으로 경량화합니다.
라벨 기준은 픽셀 기준으로 세 가지 클래스로 나눕니다. 배경, 정상 비드, 결함입니다. 각 클래스를 정확히 분리해야 나중에 면적이나 형상을 계산할 수 있습니다.
성능 지표는 IoU와 경계 F-score를 씁니다. IoU는 예측과 실제가 겹치는 비율이고, 경계 F-score는 경계선이 얼마나 정확한지를 측정합니다. 
용접 검사는 비드 경계의 미세한 차이가 중요하므로, 경계 품질이 핵심입니다. 

다음은 결함 검출 캐스케이드 파이프라인을 보겠습니다. 정밀도와 속도를 동시에 확보하는 다단계 검사 구조를 설명하겠습니다.
1단계는 ROI 추출입니다. 먼저 비드가 어디 있는지 찾고, 그 영역만 ROI로 추출합니다. 배경이나 불필요한 부분을 제거해서 2단계의 정밀 검출의 부담을 줄이는 거죠.
2단계는 결함 세그멘테이션과 검출입니다. 추출된 ROI 내에서 Anchor-free 검출기로 결함을 찾습니다. FCOS나 CenterNet 같은 모델이 작은 결함에 유리합니다. 동시에 세그멘테이션으로 정확한 경계를 얻습니다.
3단계, 후처리는 형상/크기 필터링하여 미세 노이즈를 제거하거나, 모폴로지 연산을 통해 Dilation/Erosion으로 영역 보정을 적용합니다. 
마지막으로 최종 판정 단계에서는 NMS로 중복 검출을 제거하고, 클러스터링으로 인접한 작은 결함을 하나로 묶습니다. 최종적으로 OK나 NG를 분류하고 결과를 시각화 합니다.

다음으로 조립 치수 및 간극을 정밀하게 측정하는 방법을 보겠습니다.
첫 단계는 Cad 참조 정합입니다. Three-D Cad 모델과 카메라 영상을 매칭하는 PnP나 포즈 추정 알고리즘을 씁니다. 이렇게 하면 이미지 좌표를 실제 물리적 좌표로 변환할 수 있죠.
두 번째는 키포인트 검출입니다. 부품의 특정 지점, 예를 들어 볼트 구멍이나 모서리 같은 랜드마크를 CNN으로 찾습니다. 두 부품 간 키포인트의 거리를 계산하면 간극이 나오고, 각도를 비교하면 정렬 오차가 나옵니다.
세 번째는 공차 판정입니다. 계산된 값이 삼-시그마 범위 내인지, 설계 규격을 벗어나지 않는지 체크합니다. 예를 들어 간극이 1.2mm plus-minus 0.1mm여야 하는데 1.4mm가 나오면 NG 판정이 내려지죠.

AI 검사 시스템을 실제 생산 라인에 통합하는 과정을 살펴보겠습니다.
첫째, PLC 인터페이스입니다. AI가 NG 판정을 내리면 PLC에 신호를 보내서 해당 제품을 자동으로 배출 라인으로 보냅니다. 동시에 알람을 울려서 작업자가 확인하도록 하죠. 이 과정이 밀리초 단위로 동기화돼야 합니다.
둘째, MES와 ERP 연계입니다. 검사 결과를 로트 번호, 시리얼 번호와 함께 기록해서 추적성을 확보합니다. 나중에 고객 클레임이 들어오면 해당 제품이 언제 어떤 라인에서 만들어졌는지, 검사 결과는 어땠는지 바로 조회할 수 있죠.
셋째, 모델 배포와 관리입니다. 컨테이너로 패키징해서 여러 라인에 일괄 배포하고, 원격 업데이트로 모델 버전을 관리합니다. 
마지막으로 헬스 체크입니다. 해당 단계에서는 시스템 상태를 감시해서, 문제 발생 시 즉각 알림을 받습니다.

시스템을 실전 투입한 후의 운영 관리 방법을 예시 모니터링 결과를 통해 살펴보겠습니다.
드리프트 감지가 핵심입니다. 입력 이미지의 분포가 학습 데이터와 달라지거나, 성능 지표가 떨어지면 모델이 구식이 된 겁니다. 예를 들어 새로운 타입의 결함이 나타나거나, 조명 설비를 바꿔서 이미지 톤이 달라지면 재학습이 필요하죠.
재학습 주기는 월 1회 정도로 설정합니다. 운영 중에 발생한 하드 마이닝 샘플, 즉 모델이 틀렸던 케이스들을 모아서 추가 학습시킵니다. 이렇게 하면 모델이 점점 현장 환경에 적응하게 됩니다.
KPI는 네 가지입니다. 결함 유실률은 실제 불량 중 놓친 비율이고, 오탐율은 잘못 예측된 샘플의 비율입니다. 드리프트 스코어는 데이터의 변화량을 측정한 지표이고, 재학습 성능 향상도는 재학습을 통해 향상된 모델의 성능입니다. 이 지표들을 지속적으로 모니터링하면서 개선해야 합니다. 

이제 리스크와 규제를 살펴보겠습니다. AI 검사 시스템을 도입할 때 반드시 고려해야 할 세 가지 영역을 정리하겠습니다.
첫째, 안전 리스크입니다. 미탐, 즉 불량을 놓치는 경우가 가장 위험합니다. 고객에게 결함 제품이 가면 사고로 이어질 수 있죠. 그래서 AI 판정과 기존 Rule-based 검사를 이중화하거나, 임계치 구간은 사람이 최종 확인하는 휴먼 인 더 루프 방식을 권장합니다.
둘째, 데이터 윤리와 보안입니다. 현장을 촬영하다 보면 작업자 얼굴이 찍힐 수 있는데, 개인정보 비식별화 처리가 필수입니다. 제품 도면이나 공정 데이터는 지적재산권 보호 대상이므로 암호화와 접근 통제가 필요하죠. 학습 데이터의 편향성도 점검해야 합니다.
셋째, 규제 준수입니다. ISO/IEC과 같은 소프트웨어 품질 표준, 제약이나 바이오는 GxP 밸리데이션을 요구합니다. 판정 근거를 설명할 수 있는 XAI, 즉 설명 가능한 AI도 점점 중요해지고 있습니다.
마지막으로 리스크 매트릭스를 보시면 미탐은 빈도는 낮지만 영향도가 치명적이라 최우선 관리 대상입니다. 반면 오탐은 생산 효율에 영향을 주지만 안전 리스크는 낮죠. 이제 마지막 슬라이드로 마무리하겠습니다.

오늘 우리는 CNN의 작동 원리부터 시작해서, 합성곱이 어떻게 특징을 추출하고, VGG, ResNet과 같은 아키텍처가 어떻게 진화했는지 살펴봤습니다. MLOps로 지속 가능한 학습 체계를 만들고, 성능을 정확히 평가하는 지표도 배웠죠.
Part 이에서는 제품 외관 검사 자동화의 전 과정을 다뤘습니다. 데이터 수집부터 라벨링, 전처리, 모델 선택, 파이프라인 설계, 그리고 ROI 분석까지 실무에 바로 적용할 수 있는 내용이었습니다.
Part 삼에서는 용접과 조립 품질 검사로 확장했습니다. 세그멘테이션으로 비드를 분석하고, 캐스케이드 파이프라인으로 결함을 검출하며, Cad 정합으로 치수를 측정하는 고급 기법들을 소개했습니다.
추가로 90일 실행 로드맵을 말씀드리면, 먼저 POC 설계 단계에서 요구사항을 명확히 하고 데이터를 수집합니다. 다음 30일은 파일럿 운영으로 한 라인에서 실증하고, 마지막 30일은 전체 라인으로 확산하는 겁니다.

강의를 들어주셔서 감사합니다.
